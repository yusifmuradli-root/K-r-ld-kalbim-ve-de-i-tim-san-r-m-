<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C2026 | ƒ∞mtahana Hazƒ±rlƒ±q</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4F46E5;
            --primary-hover: #4338ca;
            --secondary: #10B981;
            --bg-body: #F3F4F6;
            --bg-card: #FFFFFF;
            --text-dark: #1F2937;
            --text-gray: #6B7280;
            --radius: 16px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-body); color: var(--text-dark); line-height: 1.6; }
        header { background: linear-gradient(135deg, var(--primary), #818CF8); color: white; padding: 3rem 1rem; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; box-shadow: var(--shadow); margin-bottom: 2rem; }
        header h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        
        .search-container {
            max-width: 800px;
            margin: -1.5rem auto 2rem;
            padding: 0 1rem;
            position: relative;
            z-index: 20;
            display: flex;
            gap: 10px;
        }
        .search-box { flex: 1; position: relative; }
        .search-box input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-family: inherit;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            outline: none;
            transition: all 0.3s;
        }
        .search-box input:focus { box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.3); }
        .search-icon { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); font-size: 1.2rem; opacity: 0.5; }
        .random-btn {
            background: linear-gradient(135deg, var(--secondary), #34D399);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3);
            transition: all 0.3s;
            font-family: inherit;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .random-btn:hover { transform: translateY(-2px); box-shadow: 0 15px 20px -3px rgba(16, 185, 129, 0.4); }
        .random-btn:active { transform: scale(0.95); }

        nav { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin: 0 auto 2rem; padding: 0 1rem; position: relative; z-index: 10; }
        .nav-btn { background: white; border: none; padding: 12px 25px; border-radius: 50px; font-weight: 600; color: var(--text-gray); cursor: pointer; box-shadow: var(--shadow); transition: all 0.3s ease; font-family: inherit; }
        .nav-btn:hover { transform: translateY(-3px); color: var(--primary); }
        .nav-btn.active { background: var(--primary); color: white; box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.4); }
        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px 40px; min-height: 60vh; }
        .category-title { font-size: 1.4rem; font-weight: 700; margin: 30px 0 15px; padding-left: 15px; border-left: 5px solid var(--primary); color: var(--text-dark); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        
        /* Kart Dizaynƒ± - Yeni */
        .card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            border: 1px solid #E5E7EB;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }
        .badge {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            text-transform: uppercase;
        }
        .badge.image { background: #DBEAFE; color: #1E40AF; }
        .badge.video { background: #FEE2E2; color: #991B1B; }
        .badge.pdf { background: #DCFCE7; color: #166534; }
        .badge.link { background: #F3F4F6; color: #374151; }
        .card h3 {
            font-size: 1.15rem;
            margin-bottom: 8px;
            color: var(--text-dark);
            padding-right: 40px;
            cursor: pointer;
        }
        .card h3:hover { color: var(--primary); }
        .card p {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-bottom: 15px;
            flex-grow: 1;
        }
        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }
        .btn-view {
            flex: 1;
            padding: 10px 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: background 0.3s;
            text-align: center;
        }
        .btn-view:hover { background: var(--primary-hover); }
        .btn-link {
            flex: 1;
            padding: 10px 15px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: background 0.3s;
            text-align: center;
            text-decoration: none;
            display: inline-block;
        }
        .btn-link:hover { background: #059669; }
        .btn-link.disabled {
            background: #D1D5DB;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* Modal - Qayda G√∂st…ôrm…ôk √ú√ß√ºn */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.show { display: flex; opacity: 1; }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        .modal.show .modal-content { transform: scale(1); }
        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            color: var(--text-gray);
            font-size: 30px;
            cursor: pointer;
            font-weight: bold;
            line-height: 1;
        }
        .modal-close:hover { color: var(--primary); }
        .modal-title {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #E5E7EB;
        }
        .modal-description {
            font-size: 1rem;
            color: var(--text-gray);
            margin-bottom: 20px;
            padding: 15px;
            background: #F9FAFB;
            border-radius: 8px;
        }
        .modal-rule {
            font-size: 1rem;
            color: var(--text-dark);
            line-height: 1.8;
            padding: 20px;
            background: #EFF6FF;
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            white-space: pre-wrap;
        }
        .modal-image {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 20px;
        }

        footer {
            text-align: center;
            padding: 2rem;
            background: white;
            color: var(--text-gray);
            font-size: 0.9rem;
            margin-top: auto;
            border-top: 1px solid #E5E7EB;
        }
        
        @media (max-width: 600px) {
            .search-container { flex-direction: column; }
            .random-btn { justify-content: center; }
            .card-actions { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header>
        <h1>C2026 Hazƒ±rlƒ±q Portalƒ±</h1>
        <p>B√ºt√ºn resurslar bir yerd…ô</p>
    </header>

    <div class="search-container">
        <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="M√∂vzu, kateqoriya v…ô ya a√ßar s√∂z axtar..." autocomplete="off">
        </div>
        <button class="random-btn" onclick="showRandomTopic()">
            <span>üé≤</span>
            <span>T…ôsad√ºfi M√∂vzu</span>
        </button>
    </div>

    <nav id="navbar"></nav>
    <div class="container" id="content-area">
        <div class="status">‚è≥ M…ôlumatlar y√ºkl…ônir...</div>
    </div>

    <!-- Modal - Qayda v…ô M…ôlumat G√∂st…ôrm…ôk √ú√ß√ºn -->
    <div id="infoModal" class="modal" onclick="closeModal(event)">
        <span class="modal-close" onclick="closeModal(event)">&times;</span>
        <div class="modal-content">
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-description" id="modalDescription"></div>
            <div class="modal-rule" id="modalRule"></div>
            <img id="modalImage" class="modal-image" style="display: none;">
        </div>
    </div>

    <footer>
        <p>&copy; 2024 C2026 Layih…ôsi. Yusf t…ôr…ôfind…ôn hazƒ±rlanmƒ±≈üdƒ±r.</p>
        <p style="font-size: 0.8rem; margin-top: 5px; opacity: 0.7;">GitHub Pages √ºz…ôrind…ô hostinq edilir.</p>
    </footer>

    <script>
        const subjects = {
            'azerbaycan': 'üá¶üáø Az…ôrbaycan Dili',
            'ingilis': 'üá¨üáß ƒ∞ngilis Dili',
            'riyaziyyat': 'üìê Riyaziyyat'
        };

        let currentSubject = 'azerbaycan';
        let dbData = {};
        let allTopics = [];

        const navbar = document.getElementById('navbar');
        const contentArea = document.getElementById('content-area');
        const modal = document.getElementById('infoModal');
        const searchInput = document.getElementById('searchInput');

        // 1. M…ôlumatlarƒ± Y√ºkl…ô
        async function loadData() {
            try {
                const response = await fetch('data.json?t=' + new Date().getTime());
                if (!response.ok) throw new Error(`HTTP x…ôtasƒ±: ${response.status}`);
                const text = await response.text();
                try {
                    dbData = JSON.parse(text);
                    collectAllTopics();
                    initApp();
                } catch (e) {
                    throw new Error('JSON formatƒ± s…ôhvdir!');
                }
            } catch (error) {
                contentArea.innerHTML = `<div class="error"><strong>‚ùå X…ôta:</strong><br>${error.message}<br><small>data.json faylƒ±nƒ± yoxlayƒ±n.</small></div>`;
            }
        }

        function collectAllTopics() {
            allTopics = [];
            for (const [subjectKey, subjectData] of Object.entries(dbData)) {
                for (const [category, items] of Object.entries(subjectData)) {
                    if (items && items.length > 0) {
                        items.forEach(item => {
                            allTopics.push({
                                subject: subjectKey,
                                subjectName: subjects[subjectKey],
                                category: category,
                                ...item
                            });
                        });
                    }
                }
            }
        }

        function initApp() {
            renderNav();
            renderContent(currentSubject);
            setupSearch();
        }

        function renderNav() {
            navbar.innerHTML = '';
            for (const key in subjects) {
                const btn = document.createElement('button');
                btn.className = `nav-btn ${key === currentSubject ? 'active' : ''}`;
                btn.textContent = subjects[key];
                btn.onclick = () => switchSubject(key);
                navbar.appendChild(btn);
            }
        }

        function switchSubject(key) {
            currentSubject = key;
            searchInput.value = '';
            renderNav();
            renderContent(key);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function setupSearch() {
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase().trim();
                if (query === '') {
                    renderContent(currentSubject);
                    return;
                }
                const results = allTopics.filter(topic => {
                    return topic.title.toLowerCase().includes(query) ||
                           topic.description.toLowerCase().includes(query) ||
                           topic.category.toLowerCase().includes(query) ||
                           topic.subjectName.toLowerCase().includes(query);
                });
                renderSearchResults(results, query);
            });

            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    searchInput.value = '';
                    renderContent(currentSubject);
                    searchInput.blur();
                }
            });
        }

        function renderSearchResults(results, query) {
            contentArea.innerHTML = '';
            const infoPanel = document.createElement('div');
            infoPanel.style.cssText = 'background: #EFF6FF; border: 1px solid #BFDBFE; color: #1E40AF; padding: 12px 20px; border-radius: 10px; margin-bottom: 20px; font-size: 0.9rem; display: flex; justify-content: space-between; align-items: center;';
            infoPanel.innerHTML = `
                <span>üîç "<strong>${query}</strong>" √º√ß√ºn ${results.length} n…ôtic…ô tapƒ±ldƒ±</span>
                <button onclick="clearSearch()" style="background: none; border: none; color: var(--primary); cursor: pointer; font-weight: 600; font-size: 0.9rem;">T…ômizl…ô ‚úï</button>
            `;
            contentArea.appendChild(infoPanel);

            if (results.length === 0) {
                contentArea.innerHTML += `
                    <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                        <div style="font-size: 3rem; margin-bottom: 10px; opacity: 0.5;">üòï</div>
                        <h3>He√ß n…ô tapƒ±lmadƒ±</h3>
                        <p>F…ôrqli a√ßar s√∂zl…ôrl…ô axtarƒ±≈ü edin.</p>
                    </div>
                `;
                return;
            }

            const grouped = {};
            results.forEach(topic => {
                const key = `${topic.subject}|${topic.category}`;
                if (!grouped[key]) {
                    grouped[key] = {
                        subject: topic.subject,
                        subjectName: topic.subjectName,
                        category: topic.category,
                        items: []
                    };
                }
                grouped[key].items.push(topic);
            });

            for (const group of Object.values(grouped)) {
                const catTitle = document.createElement('div');
                catTitle.className = 'category-title';
                const formattedCat = group.category.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                catTitle.innerHTML = `${group.subjectName} ‚Ä¢ üìÇ ${formattedCat}`;
                contentArea.appendChild(catTitle);

                const grid = document.createElement('div');
                grid.className = 'grid';

                group.items.forEach(item => {
                    const card = createCard(item);
                    grid.appendChild(card);
                });

                contentArea.appendChild(grid);
            }
        }

        function clearSearch() {
            searchInput.value = '';
            renderContent(currentSubject);
        }

        function showRandomTopic() {
            if (allTopics.length === 0) {
                alert('‚ö†Ô∏è Hal-hazƒ±rda g√∂st…ôril…ôc…ôk m√∂vzu yoxdur!');
                return;
            }

            const randomIndex = Math.floor(Math.random() * allTopics.length);
            const randomTopic = allTopics[randomIndex];
            openModal(randomTopic);
        }

        // Modal A√ßmaq
        function openModal(topic) {
            document.getElementById('modalTitle').textContent = topic.title;
            document.getElementById('modalDescription').textContent = topic.description || '∆ètraflƒ± m…ôlumat';
            document.getElementById('modalRule').textContent = topic.qayda || 'Qayda m…ôlumatƒ± …ôlav…ô edilm…ôyib.';
            
            const modalImg = document.getElementById('modalImage');
            if (topic.type === 'image' && topic.link && topic.link !== '#') {
                modalImg.src = topic.link;
                modalImg.style.display = 'block';
            } else {
                modalImg.style.display = 'none';
            }

            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(e) {
            if (e.target === modal || e.target.classList.contains('modal-close')) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.classList.contains('show')) {
                closeModal({target: modal});
            }
        });

        // Kart Yaratmaq
        function createCard(item) {
            const card = document.createElement('div');
            card.className = 'card';
            const typeClass = item.type || 'link';
            const typeLabel = typeClass.toUpperCase();

            // Ba≈ülƒ±ƒüa klikl…ôy…ônd…ô modal a√ßƒ±lsƒ±n
            const title = document.createElement('h3');
            title.textContent = item.title;
            title.onclick = () => openModal(item);
            title.style.cursor = 'pointer';

            const description = document.createElement('p');
            description.textContent = item.description || '∆ètraflƒ± m…ôlumat √º√ß√ºn ba≈ülƒ±ƒüa klikl…ôyin.';

            const badge = document.createElement('span');
            badge.className = `badge ${typeClass}`;
            badge.textContent = typeLabel;

            const actions = document.createElement('div');
            actions.className = 'card-actions';

            // Qaydaya bax d√ºym…ôsi
            const btnView = document.createElement('button');
            btnView.className = 'btn-view';
            btnView.textContent = 'üìñ Qaydaya Bax';
            btnView.onclick = () => openModal(item);

            // Link d√ºym…ôsi
            const btnLink = document.createElement('a');
            btnLink.className = 'btn-link';
            btnLink.textContent = 'üîó Ke√ßid';
            btnLink.target = '_blank';
            
            if (item.link && item.link !== '#') {
                btnLink.href = item.link;
                btnLink.classList.remove('disabled');
            } else {
                btnLink.href = '#';
                btnLink.classList.add('disabled');
                btnLink.textContent = 'üîó Tezlikl…ô';
            }

            actions.appendChild(btnView);
            actions.appendChild(btnLink);

            card.appendChild(badge);
            card.appendChild(title);
            card.appendChild(description);
            card.appendChild(actions);

            return card;
        }

        function renderContent(subjectKey) {
            contentArea.innerHTML = '';
            const data = dbData[subjectKey];

            if (!data || Object.keys(data).length === 0) {
                contentArea.innerHTML = '<div class="status">Bu f…ônn √º√ß√ºn h…ôl…ô m…ôlumat …ôlav…ô edilm…ôyib.</div>';
                return;
            }

            for (const [category, items] of Object.entries(data)) {
                if (!items || items.length === 0) continue;

                const catTitle = document.createElement('div');
                catTitle.className = 'category-title';
                const formattedCat = category.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                catTitle.innerHTML = `üìÇ ${formattedCat}`;
                contentArea.appendChild(catTitle);

                const grid = document.createElement('div');
                grid.className = 'grid';

                items.forEach(item => {
                    const card = createCard(item);
                    grid.appendChild(card);
                });

                contentArea.appendChild(grid);
            }
        }

        // ƒ∞≈ü…ô Sal
        loadData();
    </script>
</body>
</html>
